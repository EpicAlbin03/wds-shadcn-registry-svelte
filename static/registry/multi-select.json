{
	"$schema": "https://shadcn-svelte.com/schema/registry-item.json",
	"name": "multi-select",
	"type": "registry:ui",
	"devDependencies": [
		"@lucide/svelte@^0.544.0",
		"bits-ui@^2.14.1",
		"@internationalized/date@^3.10.0",
		"runed@^0.35.1"
	],
	"registryDependencies": [
		"utils",
		"badge",
		"command",
		"popover"
	],
	"files": [
		{
			"content": "import Root, { type MultiSelectProps } from './multi-select.svelte';\r\n\r\nexport {\r\n\tRoot,\r\n\ttype MultiSelectProps,\r\n\t//\r\n\tRoot as MultiSelect,\r\n\ttype MultiSelectProps as Props\r\n};\r\n",
			"type": "registry:file",
			"target": "multi-select/index.ts"
		},
		{
			"content": "<script lang=\"ts\">\r\n\timport { CheckIcon, ChevronsUpDownIcon, XIcon } from '@lucide/svelte';\r\n\timport { cn } from '$UTILS$';\r\n\timport { Badge } from '$lib/components/ui/badge';\r\n\timport * as Command from '$lib/components/ui/command';\r\n\timport { Select as SelectPrimitive, type SelectMultipleRootProps } from 'bits-ui';\r\n\timport * as Popover from '$lib/components/ui/popover';\r\n\timport { useResizeObserver, watch } from 'runed';\r\n\r\n\texport type MultiSelectProps = {\r\n\t\tplaceholder?: string;\r\n\t\tplaceholderSearch?: string;\r\n\t\temptySearchMessage?: string;\r\n\t\tdisableSearch?: boolean;\r\n\t\toverflowBehavior?: 'wrap' | 'wrap-when-open' | 'cutoff';\r\n\t\titems: {\r\n\t\t\tvalue: string;\r\n\t\t\tlabel: string;\r\n\t\t\tbadgeLabel?: string;\r\n\t\t\tdisabled?: boolean;\r\n\t\t}[];\r\n\t} & Omit<SelectMultipleRootProps, 'type'>;\r\n\r\n\tlet {\r\n\t\topen = $bindable(false),\r\n\t\tvalue = $bindable([]),\r\n\t\titems = [],\r\n\t\tclass: className,\r\n\t\tdisableSearch = false,\r\n\t\tplaceholder = undefined,\r\n\t\tplaceholderSearch = undefined,\r\n\t\temptySearchMessage = undefined,\r\n\t\toverflowBehavior = 'wrap-when-open',\r\n\t\t...props\r\n\t}: MultiSelectProps = $props();\r\n\r\n\tlet containerElement = $state<HTMLElement>(null!);\r\n\tlet overflowElement = $state<HTMLElement>(null!);\r\n\r\n\tlet search = $state('');\r\n\tlet shouldWrap = $derived(\r\n\t\toverflowBehavior === 'wrap' || (overflowBehavior === 'wrap-when-open' && open)\r\n\t);\r\n\tlet overflowAmount = $state(0);\r\n\r\n\tfunction toggleValue(v: string) {\r\n\t\tif (value.includes(v)) value = value.filter((x) => x !== v);\r\n\t\telse value = [...value, v];\r\n\t}\r\n\r\n\tfunction removeValue(v: string) {\r\n\t\tvalue = value.filter((x) => x !== v);\r\n\t}\r\n\r\n\tfunction checkOverflow() {\r\n\t\tif (!containerElement) return;\r\n\t\tconst items = containerElement.querySelectorAll<HTMLElement>('[data-selected-item]');\r\n\r\n\t\tif (overflowElement) overflowElement.style.display = 'none';\r\n\t\titems.forEach((child) => child.style.removeProperty('display'));\r\n\r\n\t\tlet amount = 0;\r\n\t\tfor (let i = items.length - 1; i >= 0; i--) {\r\n\t\t\tconst child = items[i]!;\r\n\t\t\tif (containerElement.scrollWidth <= containerElement.clientWidth) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tamount = items.length - i;\r\n\t\t\tchild.style.display = 'none';\r\n\t\t\toverflowElement?.style.removeProperty('display');\r\n\t\t}\r\n\r\n\t\toverflowAmount = amount;\r\n\t}\r\n\r\n\tuseResizeObserver(() => containerElement, checkOverflow);\r\n\r\n\twatch(() => open, checkOverflow);\r\n</script>\r\n\r\n<SelectPrimitive.Root type=\"multiple\" bind:value {...props}>\r\n\t<Popover.Root bind:open>\r\n\t\t<Popover.Trigger>\r\n\t\t\t{#snippet child({ props })}\r\n\t\t\t\t<SelectPrimitive.Trigger\r\n\t\t\t\t\t{...props}\r\n\t\t\t\t\tdata-slot=\"select-trigger\"\r\n\t\t\t\t\tdata-size=\"default\"\r\n\t\t\t\t\tclass={cn(\r\n\t\t\t\t\t\t\"flex !h-auto min-h-9 w-fit items-center gap-2 overflow-hidden rounded-md border border-input bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none select-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[placeholder]:text-muted-foreground data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 dark:bg-input/30 dark:hover:bg-input/50 dark:aria-invalid:ring-destructive/40 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground\",\r\n\t\t\t\t\t\tclassName\r\n\t\t\t\t\t)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tbind:this={containerElement}\r\n\t\t\t\t\t\tclass={cn('flex w-fit gap-1.5 overflow-hidden', shouldWrap && 'h-full flex-wrap')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if value.length === 0}\r\n\t\t\t\t\t\t\t{placeholder}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{#each value as v (v)}\r\n\t\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\t\tdata-selected-item\r\n\t\t\t\t\t\t\t\t\tclass=\"flex items-center gap-1 hover:[&>svg]:text-destructive\"\r\n\t\t\t\t\t\t\t\t\tonclick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\tremoveValue(v);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{@const item = items.find((f) => f.value === v)}\r\n\t\t\t\t\t\t\t\t\t{item?.badgeLabel ?? item?.label}\r\n\t\t\t\t\t\t\t\t\t<XIcon class=\"size-2 shrink-0 text-muted-foreground\" />\r\n\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\tbind:ref={overflowElement}\r\n\t\t\t\t\t\t\t\tvariant=\"outline\"\r\n\t\t\t\t\t\t\t\tstyle={`display: ${overflowAmount > 0 && !shouldWrap ? 'block' : 'none'}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t+{overflowAmount}\r\n\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<ChevronsUpDownIcon class=\"ml-auto size-4 opacity-50\" />\r\n\t\t\t\t</SelectPrimitive.Trigger>\r\n\t\t\t{/snippet}\r\n\t\t</Popover.Trigger>\r\n\r\n\t\t<Popover.Content class=\"min-w-[var(--bits-popover-anchor-width)] p-0\">\r\n\t\t\t<Command.Root>\r\n\t\t\t\t{#if !disableSearch}\r\n\t\t\t\t\t<Command.Input placeholder={placeholderSearch} bind:value={search} />\r\n\t\t\t\t{/if}\r\n\t\t\t\t<Command.List>\r\n\t\t\t\t\t<Command.Empty>{emptySearchMessage}</Command.Empty>\r\n\t\t\t\t\t<Command.Group>\r\n\t\t\t\t\t\t{#each items as item (item.value)}\r\n\t\t\t\t\t\t\t<Command.Item onSelect={() => toggleValue(item.value)}>\r\n\t\t\t\t\t\t\t\t<CheckIcon\r\n\t\t\t\t\t\t\t\t\tclass={cn(\r\n\t\t\t\t\t\t\t\t\t\t'mr-2 size-4',\r\n\t\t\t\t\t\t\t\t\t\tvalue.includes(item.value) ? 'opacity-100' : 'opacity-0'\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{item.label}\r\n\t\t\t\t\t\t\t</Command.Item>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</Command.Group>\r\n\t\t\t\t</Command.List>\r\n\t\t\t</Command.Root>\r\n\t\t</Popover.Content>\r\n\t</Popover.Root>\r\n</SelectPrimitive.Root>\r\n",
			"type": "registry:file",
			"target": "multi-select/multi-select.svelte"
		}
	]
}